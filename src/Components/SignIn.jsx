import React, { useState } from "react";
import { signInWithGoogle } from "../../firebase";
import { auth } from "../../firebase";
import { View, Text, TextInput, Button } from 'react-native';
import {Link} from 'react-router-native';
import * as Google from "expo-google-app-auth";


const SignIn = () => {
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');


    //Esta funcion es para comprobar la existencia de una cuenta en la BD de firebase.
    const signInWithEmailAndPasswordHandler = (event, email, password) => {
        event.preventDefault();
        auth.signInWithEmailAndPassword(email, password).catch(error => {
            console.error("Error signing in with password and email", error);
        });
    };
    const onChangeHandler = (event) => {
        const { name, value } = event.currentTarget;
        if (name === 'userEmail') {
            setEmail(value);
        }
        else if (name === 'userPassword') {
            setPassword(value);
        }
    };

    const signInAsync = async () => {
        console.log("LoginScreen.js 6 | loggin in");
        try {
          const { type, user } = await Google.logInAsync({
            iosClientId: `<YOUR_IOS_CLIENT_ID>`,
            androidClientId: `<YOUR_ANDROID_CLIENT_ID>`,
          });
    
          if (type === "success") {
            // Then you can use the Google REST API
            console.log("LoginScreen.js 17 | success, navigating to profile");
            navigation.navigate("Profile", { user });
          }
        } catch (error) {
          console.log("LoginScreen.js 19 | error with login", error);
        }
      };

    return (
        <View>
            <Text h1>BIENVENIDOS AL SISTEMA</Text>
            <TextInput value={email} onChangeText={email => setEmail(email)} placeholder="Ingrese su correo"></TextInput>
            <TextInput value={password} onChangeText={password => setPassword(password)} placeholder="Ingrese su contraseÃ±a" ></TextInput>

            <Button title="Iniciar Sesion" onPress={(event) => { signInWithEmailAndPasswordHandler(event, email, password) }}/>

            <Button title="Google" onPress={signInAsync}/>

            <Link to="/" >
                <Text>Registrarme</Text>
            </Link>

        </View>
    );
}

export default SignIn;

























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































